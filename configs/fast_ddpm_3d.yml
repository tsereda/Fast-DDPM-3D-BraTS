model:
  type: fast_ddpm
  in_channels: 4
  out_ch: 1
  ch: 48
  ch_mult:
  - 1
  - 2
  - 4
  - 8
  num_res_blocks: 2
  attn_resolutions:
  - 16
  dropout: 0.1
  var_type: learned_range
  ema_rate: 0.9999
  ema: true
  resamp_with_conv: true
diffusion:
  beta_schedule: cosine
  beta_start: 0.0001
  beta_end: 0.02
  num_diffusion_timesteps: 1000
  loss_type: hybrid
  sampling_timesteps: 10
  sampling_scheduler: non-uniform
  clip_denoised: true
training:
  batch_size: 1
  learning_rate: 0.0001
  weight_decay: 0
  epochs: 100
  gradient_clip: 1.0
  optimizer: adamw
  beta1: 0.9
  beta2: 0.999
  warmup_steps: 1000
  lr_scheduler: cosine
  lr_min: 1e-6
  save_every: 1000
  validate_every: 500
  log_every: 100
  mixed_precision: true
  gradient_checkpointing: true
  accumulate_grad_batches: 4
data:
  volume_size:
  - 80
  - 80
  - 80
  volume_sizes:
    8GB:
    - 64
    - 64
    - 64
    11GB:
    - 80
    - 80
    - 80
    16GB:
    - 96
    - 96
    - 96
    24GB:
    - 112
    - 112
    - 112
    32GB:
    - 128
    - 128
    - 128
    40GB:
    - 144
    - 144
    - 144
    80GB:
    - 160
    - 160
    - 160
  normalize: true
  num_workers: 4
  pin_memory: true
  prefetch_factor: 2
  augmentation:
    rotation: true
    rotation_angles:
    - -10
    - 10
    flip: true
    flip_prob: 0.5
    elastic: false
    color_jitter: true
    brightness:
    - 0.9
    - 1.1
    contrast:
    - 0.9
    - 1.1
  min_input_modalities: 1
  max_input_modalities: 3
memory_optimization:
  gradient_accumulation_steps: 4
  checkpoint_layers:
  - mid
  - up.0
  - up.1
  cpu_offload: false
  clear_cache_every: 100
logging:
  use_wandb: false
  project_name: fast-ddpm-3d-brats
  log_images_every: 1000
  log_metrics:
  - loss
  - mse
  - vlb
  - grad_norm
evaluation:
  metrics:
  - mse
  - psnr
  - ssim
  - lpips_3d
  save_samples: true
  num_samples: 5
